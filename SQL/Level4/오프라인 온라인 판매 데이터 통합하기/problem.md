# 오프라인 온라인 판매 데이터 통합하기

## 문제 링크

https://school.programmers.co.kr/learn/courses/30/lessons/131537

## 문제 분류

: SELECT

## 풀이 과정

JOIN을 사용해서 풀이하려고 했는데 잘 되지 않았다. 알고보니 UNION을 사용해서 풀이할 수 있었다.

1. ONLINE_SALE, OFFLINE_SALE 데이터 모두 2022년 3월에 판매한 상품들만 남긴다.
2. SALES_DATE, PRODUCT_ID, USER_ID, SALES_AMOUNT를 선택하는데, OFFLINE_SALE의 경우 USER_ID를 NULL로 표시한다.
3. UNION을 통해 이 둘의 데이터를 합쳐준다.
4. SALES_DATE, PRODUCT_ID, USER_ID를 기준으로 오름차순 정렬을 해준다.

## 풀이 코드

```sql
SELECT DATE_FORMAT(SALES_DATE, '%Y-%m-%d') AS SALES_DATE, PRODUCT_ID, USER_ID, SALES_AMOUNT
FROM ONLINE_SALE
WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 3
UNION
SELECT DATE_FORMAT(SALES_DATE, '%Y-%m-%d') AS SALES_DATE, PRODUCT_ID, NULL AS USER_ID, SALES_AMOUNT
FROM OFFLINE_SALE
WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 3
ORDER BY SALES_DATE ASC, PRODUCT_ID ASC, USER_ID ASC;
```

## 다른 풀이

먼저 UNION을 한 후에 데이터를 뽑아낼 수도 있다.

```sql
SELECT DATE_FORMAT(SALES_DATE, '%Y-%m-%d') AS SALES DATE, PRODUCT_ID, USER_ID, SALES_AMOUNT
FROM (
  SELECT SALES_DATE, PRODUCT_ID, USER_ID, SALES_AMOUNT FROM ONLINE_SALE
  UNION
  SELECT SALES_DATE, PRODUCT_ID, NULL AS USER_ID, SALES_AMOUNT FROM OFFLINE_SALE
) SALE
WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 3
ORDER BY SALES_DATE ASC, PRODUCT_ID ASC, USER_ID ASC;
```
